<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Wake on Lan and Dual Boot - DrosoCode</title><meta name=Description content><meta property="og:title" content="Wake on Lan and Dual Boot">
<meta property="og:description" content="Introduction Wake on Lan is a technology delvelopped in 1995, that allows you to start a computer by sending a magic packet (usually in udp). I use it since a few years and it is especially useful when you are in a remote place, you can just start your computer and connect to it through rdp. The only problem is that this approach is not really suitable for dual-boot setups.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://thomasz.me/2020/10/06/wake-on-lan-and-dual-boot/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-10-06T00:00:00+01:00">
<meta property="article:modified_time" content="2020-10-06T00:00:00+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Wake on Lan and Dual Boot">
<meta name=twitter:description content="Introduction Wake on Lan is a technology delvelopped in 1995, that allows you to start a computer by sending a magic packet (usually in udp). I use it since a few years and it is especially useful when you are in a remote place, you can just start your computer and connect to it through rdp. The only problem is that this approach is not really suitable for dual-boot setups.">
<meta name=application-name content="DrosoCode">
<meta name=apple-mobile-web-app-title content="DrosoCode"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://thomasz.me/2020/10/06/wake-on-lan-and-dual-boot/><link rel=prev href=https://thomasz.me/2020/10/04/use-your-oculus-rift-completly-offline/><link rel=next href=https://thomasz.me/2020/11/03/control-your-light-with-a-nintendo-ds/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Wake on Lan and Dual Boot","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thomasz.me\/2020\/10\/06\/wake-on-lan-and-dual-boot\/"},"genre":"posts","keywords":"arduino, boostrap, c\u002b\u002b, cordova, web, wol, hardware","wordcount":1204,"url":"https:\/\/thomasz.me\/2020\/10\/06\/wake-on-lan-and-dual-boot\/","datePublished":"2020-10-06T00:00:00+01:00","dateModified":"2020-10-06T00:00:00+01:00","publisher":{"@type":"Organization","name":"drosocode"},"author":{"@type":"Person","name":"droso"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>DrosoCode</a>
</div><div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/projects/> Projects </a><a class=menu-item href=https://github.com/drosocode rel="noopener noreffer" target=_blank> Github </a><a class=menu-item href=/about/> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div></div></div></header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>DrosoCode</a>
</div><div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div></div><div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/projects/ title>Projects</a><a class=menu-item href=https://github.com/drosocode title rel="noopener noreffer" target=_blank>Github</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div></div></header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div></div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Wake on Lan and Dual Boot</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://github.com/drosocode title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>droso</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-06>2020-10-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1204 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#introduction>Introduction</a></li><li><a href=#the-problem>The Problem</a></li><li><a href=#the-solution>The Solution</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>Wake on Lan is a technology delvelopped in 1995, that allows you to start a computer by sending a magic packet (usually in udp). I use it since a few years and it is especially useful when you are in a remote place, you can just start your computer and connect to it through rdp. The only problem is that this approach is not really suitable for dual-boot setups.</p><h2 id=the-problem>The Problem</h2><p>Sometimes, I need to run linux process that are using the GPU, so until the gpu support is added to the WSL2, a dual-boot is mandatory for me. However, a magic packet allows you to start you computer but you have no way to interact with it until the os is fully started. So it’s impossible to access boot menu using wake on lan.</p><h2 id=the-solution>The Solution</h2><p>So, if it’s impossible to do it in software, let’s use some hardware ! Our setup will be very simple: an Arduino Leonardo and an Ethernet Shield. Why a leonardo and not a uno or a nano ? Because, the Arduino Leonardo have a different kind of usb controller that allows to emulate an HID device, especially a keyboard in our case.</p><figure><a class=lightgallery href=/2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg title=/2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg data-thumbnail=/2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg data-sub-html="<h2>Arduino Leonardo with Ethernet shield</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=assets/arduino.jpg data-srcset="/2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg, assets/arduino.jpg 1.5x, /2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg 2x" data-sizes=auto alt=/2020/10/06/wake-on-lan-and-dual-boot/assets/arduino.jpg width=30%>
</a><figcaption class=image-caption>Arduino Leonardo with Ethernet shield</figcaption></figure><p>The idea is to connect an ethernet shield to this arduino, so that we can send an http request with the os to start. The arduino will then send a magic packet (which is really simple to create as it is composed of 6x “FF” and 16x the mac address of the computer), wait for a predetermined amount of time (time to show the os selection screen), and then emulate the up/down/enter keys to select the correct os.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-ino data-lang=ino><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;SPI.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;Ethernet.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;Keyboard.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define bootDelay 9000 </span><span class=c1>//time to get the boot menu from wol, in ms
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#define keyPressDelay 100 </span><span class=c1>//in ms
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#define resetDelay 4
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>byte</span> <span class=n>mac</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>wolPort</span> <span class=o>=</span> <span class=mi>9</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>byte</span> <span class=n>remote_MAC_ADD</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span><span class=p>,</span> <span class=mh>0x00</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>byte</span> <span class=n>broadCastIp</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>IPAddress</span> <span class=nf>ip</span><span class=p>(</span><span class=mi>192</span><span class=p>,</span> <span class=mi>168</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nc>EthernetServer</span> <span class=nf>server</span><span class=p>(</span><span class=mi>80</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>begin</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nc>Ethernet</span><span class=p>.</span><span class=nf>begin</span><span class=p>(</span><span class=n>mac</span><span class=p>,</span> <span class=n>ip</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nc>Ethernet</span><span class=p>.</span><span class=n>hardwareStatus</span><span class=p>()</span> <span class=o>==</span> <span class=n>EthernetNoHardware</span> <span class=o>||</span> <span class=nc>Ethernet</span><span class=p>.</span><span class=n>linkStatus</span><span class=p>()</span> <span class=o>==</span> <span class=n>LinkOFF</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>server</span><span class=p>.</span><span class=nf>begin</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> 
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nc>EthernetClient</span> <span class=n>client</span> <span class=o>=</span> <span class=n>server</span><span class=p>.</span><span class=nf>available</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>client</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// an http request ends with a blank line
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>String</span> <span class=n>message</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>boolean</span> <span class=n>currentLineIsBlank</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>client</span><span class=p>.</span><span class=nf>connected</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>client</span><span class=p>.</span><span class=nf>available</span><span class=p>())</span> 
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>c</span> <span class=o>=</span> <span class=n>client</span><span class=p>.</span><span class=nf>read</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// if you&#39;ve gotten to the end of the line (received a newline
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// character) and the line is blank, the http request has ended,
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// so you can send a reply
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span> <span class=o>&amp;&amp;</span> <span class=n>currentLineIsBlank</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kt>String</span> <span class=n>param</span> <span class=o>=</span> <span class=n>message</span><span class=p>.</span><span class=nf>substring</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=n>message</span><span class=p>.</span><span class=nf>indexOf</span><span class=p>(</span><span class=s>&#34;HTTP&#34;</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=c1>// send a standard http response header
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;HTTP/1.1 200 OK&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;Access-Control-Allow-Origin: *&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;Content-Type: text/html&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;Connection: close&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>print</span><span class=p>(</span><span class=n>F</span><span class=p>(</span>\
</span></span><span class=line><span class=cl>              <span class=s>&#34;&lt;html&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                &lt;head&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                    &lt;title&gt;Wake On Lan&lt;/title&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                    &lt;meta name=&#39;viewport&#39; content=&#39;width=device-width, initial-scale=1&#39;&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                    &lt;style&gt;html{background-color:#222222;}.pure-button{display:inline-block;line-height:normal;white-space:nowrap;vertical-align:middle;text-align:center;cursor:pointer;-webkit-user-drag:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box}.pure-button::-moz-focus-inner{padding:0;border:0}.pure-button-group{letter-spacing:-.31em;text-rendering:optimizespeed}.opera-only :-o-prefocus,.pure-button-group{word-spacing:-.43em}.pure-button-group .pure-button{letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-button{font-family:inherit;font-size:100%;padding:.5em 1em;color:rgba(0,0,0,.8);border:none transparent;background-color:#e6e6e6;text-decoration:none;border-radius:2px}.pure-button-hover,.pure-button:focus,.pure-button:hover{background-image:-webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(40%,rgba(0,0,0,.05)),to(rgba(0,0,0,.1)));background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1))}.pure-button:focus{outline:0}.pure-button-active,.pure-button:active{-webkit-box-shadow:0 0 0 1px rgba(0,0,0,.15) inset,0 0 6px rgba(0,0,0,.2) inset;box-shadow:0 0 0 1px rgba(0,0,0,.15) inset,0 0 6px rgba(0,0,0,.2) inset;border-color:#000}.pure-button-disabled,.pure-button-disabled:active,.pure-button-disabled:focus,.pure-button-disabled:hover,.pure-button[disabled]{border:none;background-image:none;opacity:.4;cursor:not-allowed;-webkit-box-shadow:none;box-shadow:none;pointer-events:none}.pure-button-hidden{display:none}.pure-button-primary,.pure-button-selected,a.pure-button-primary,a.pure-button-selected{background-color:#0078e7;color:#fff}.pure-button-group .pure-button{margin:0;border-radius:0;border-right:1px solid rgba(0,0,0,.2)}.pure-button-group .pure-button:first-child{border-top-left-radius:2px;border-bottom-left-radius:2px}.pure-button-group .pure-button:last-child{border-top-right-radius:2px;border-bottom-right-radius:2px;border-right:none}.button-error,.button-secondary,.button-success,.button-warning{color:#fff;border-radius:4px;text-shadow:0 1px 1px rgba(0,0,0,.2)}.button-success{background:#1cb841}.button-error{background:#ca3c3c}.button-warning{background:#df7514}&lt;/style&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                &lt;/head&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                &lt;body&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                  &lt;br&gt;&lt;a class=&#39;button-success pure-button&#39; onclick=&#39;redir(</span><span class=se>\&#34;</span><span class=s>/0/on</span><span class=se>\&#34;</span><span class=s>)&#39;&gt;Start Windows&lt;/a&gt;&amp;nbsp;&amp;nbsp;\
</span></span></span><span class=line><span class=cl><span class=s>                  &lt;a class=&#39;button-error pure-button&#39; onclick=&#39;redir(</span><span class=se>\&#34;</span><span class=s>/0/off</span><span class=se>\&#34;</span><span class=s>)&#39;&gt;Stop Windows&lt;/a&gt;&lt;br&gt;&lt;br&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                  &lt;a class=&#39;button-success pure-button&#39; onclick=&#39;redir(</span><span class=se>\&#34;</span><span class=s>/1/on</span><span class=se>\&#34;</span><span class=s>)&#39;&gt;Start Linux&lt;/a&gt;&amp;nbsp;&amp;nbsp;\
</span></span></span><span class=line><span class=cl><span class=s>                  &lt;a class=&#39;button-error pure-button&#39; onclick=&#39;redir(</span><span class=se>\&#34;</span><span class=s>/1/off</span><span class=se>\&#34;</span><span class=s>)&#39;&gt;Stop Linux&lt;/a&gt;&lt;br&gt;&lt;br&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                  &lt;a class=&#39;button-warning pure-button&#39; onclick=&#39;redir(</span><span class=se>\&#34;</span><span class=s>/lock</span><span class=se>\&#34;</span><span class=s>)&#39;&gt;Lock&lt;/a&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                &lt;/body&gt;\
</span></span></span><span class=line><span class=cl><span class=s>                &lt;script&gt;function redir(path) { window.location.href = window.location.href + path }&lt;/script&gt;\
</span></span></span><span class=line><span class=cl><span class=s>              &lt;/html&gt;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=k>else</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;Content-Type: application/json&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;Connection: close&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>print</span><span class=p>(</span><span class=s>&#34;{</span><span class=se>\&#34;</span><span class=s>command</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>print</span><span class=p>(</span><span class=n>param</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>print</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\&#34;</span><span class=s>,</span><span class=se>\&#34;</span><span class=s>response</span><span class=se>\&#34;</span><span class=s>:</span><span class=se>\&#34;</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>print</span><span class=p>(</span><span class=n>doAction</span><span class=p>(</span><span class=n>param</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=n>client</span><span class=p>.</span><span class=nf>println</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\&#34;</span><span class=s>}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// you&#39;re starting a new line
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=n>currentLineIsBlank</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>!=</span> <span class=sc>&#39;\r&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// you&#39;ve gotten a character on the current line
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=n>currentLineIsBlank</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>+=</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>client</span><span class=p>.</span><span class=nf>stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//========================================================= WOL functions =========================
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>sendWol</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>byte</span> <span class=n>magicPacket</span><span class=p>[</span><span class=mi>102</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>i</span><span class=p>,</span><span class=n>c1</span><span class=p>,</span><span class=n>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>,</span><span class=n>j</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=n>magicPacket</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mh>0xFF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>16</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span> <span class=n>c1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>c1</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=n>c1</span><span class=o>++</span><span class=p>,</span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=n>magicPacket</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>remote_MAC_ADD</span><span class=p>[</span><span class=n>c1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>EthernetUDP</span> <span class=n>Udp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Udp</span><span class=p>.</span><span class=nf>begin</span><span class=p>(</span><span class=n>wolPort</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Udp</span><span class=p>.</span><span class=nf>beginPacket</span><span class=p>(</span><span class=n>broadCastIp</span><span class=p>,</span> <span class=n>wolPort</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Udp</span><span class=p>.</span><span class=nf>write</span><span class=p>(</span><span class=n>magicPacket</span><span class=p>,</span> <span class=k>sizeof</span> <span class=n>magicPacket</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Udp</span><span class=p>.</span><span class=nf>endPacket</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//========================================================= Actions =============================================
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>String</span> <span class=nf>doAction</span><span class=p>(</span><span class=kt>String</span> <span class=n>param</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>//0 = Windows, 1 = Ubuntu
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;0/on&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>sendWol</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>bootDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;0/off&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_LEFT_GUI</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=sc>&#39;d&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span> <span class=c1>// Windows + D
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_LEFT_ALT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_F4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span> <span class=c1>// Alt + F4
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// if the sequence failed (the computer is likely locked), continue with a sequence to poweroff from the lockscreen
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// enter -&gt; 4 tab -&gt; enter -&gt; down -&gt; enter -&gt; enter
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>char</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>4</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_TAB</span><span class=p>);</span> <span class=c1>//tab
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_DOWN_ARROW</span><span class=p>);</span> <span class=c1>//down
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;1/on&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>sendWol</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>bootDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_DOWN_ARROW</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>println</span><span class=p>();</span> <span class=c1>//enter
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;1/off&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_LEFT_CTRL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_LEFT_ALT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=sc>&#39;s&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span> <span class=c1>// Ctrl + Alt + S
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;lock&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=n>KEY_LEFT_GUI</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>press</span><span class=p>(</span><span class=sc>&#39;l&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>delay</span><span class=p>(</span><span class=n>keyPressDelay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nc>Keyboard</span><span class=p>.</span><span class=nf>releaseAll</span><span class=p>();</span> <span class=c1>// Win + L
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>param</span> <span class=o>==</span> <span class=s>&#34;status&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nc>Serial</span><span class=p>.</span><span class=nf>begin</span><span class=p>(</span><span class=mi>9600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nc>Serial</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s>&#34;true&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=s>&#34;false&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nc>Serial</span><span class=p>.</span><span class=nf>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;error&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s>&#34;ok&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>With this simple code, the arduino will start an http server on port 80, and listen for simple commands like <code>2/start</code> to start linux of <code>1/stop</code> to stop windows, we can even serve a very simple ui on the default page.</p><p>I could have stopped there, but I decided to create a simple app for my phone, to easily wake-up the computer. For this really quick project, I used Apache Cordova (though I don’t recommand using it for real projects) and bootstrap. And a few lines of html later, there is our app !</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2020/10/06/wake-on-lan-and-dual-boot/assets/app.png>
<img src=/2020/10/06/wake-on-lan-and-dual-boot/assets/app.png>
</a>
<figcaption class=image-caption>
Mobile App
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2020/10/06/wake-on-lan-and-dual-boot/assets/web.png>
<img src=/2020/10/06/wake-on-lan-and-dual-boot/assets/web.png>
</a>
<figcaption class=image-caption>
Web UI
</figcaption></figure></div><h2 id=conclusion>Conclusion</h2><p>So with less than $50, you can create a Wake On Lan device that supports multi-os systems. You could even bring wake up support to an incompatible computer using a realy or an optocoupler to “manually push the button”.</p></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2020-10-06</span>
</div><div class=post-info-license></div></div><div class=post-info-line>
<div class=post-info-md></div><div class=post-info-share>
<span></span>
</div></div></div><div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/arduino/>arduino</a>,&nbsp;<a href=/tags/boostrap/>boostrap</a>,&nbsp;<a href=/tags/c++/>c++</a>,&nbsp;<a href=/tags/cordova/>cordova</a>,&nbsp;<a href=/tags/web/>web</a>,&nbsp;<a href=/tags/wol/>wol</a>,&nbsp;<a href=/tags/hardware/>hardware</a></section><section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section></div><div class=post-nav><a href=/2020/10/04/use-your-oculus-rift-completly-offline/ class=prev rel=prev title="Use your oculus rift completly offline"><i class="fas fa-angle-left fa-fw"></i>Use your oculus rift completly offline</a>
<a href=/2020/11/03/control-your-light-with-a-nintendo-ds/ class=next rel=next title="Control your lights with a Nintendo DS">Control your lights with a Nintendo DS<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div></main><footer class=footer>
<div class=footer-container><div class=footer-line>© <script>document.write("2019 - "+(new Date).getFullYear())</script> DrosoCode | <a href=/privacy-policy>Privacy Policy</a> | <a href=/terms-of-use>Terms of Use</a> | <a href=/feed>RSS</a></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><link rel=stylesheet href=/custom.css><link rel=stylesheet href=/devicon.min.css><link rel=stylesheet href=/glide.min.css><script type=text/javascript src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2CElement.prototype.closest%2CrequestAnimationFrame%2CCustomEvent%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script type=text/javascript src=https://droso.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/glide.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config",{client_storage:"none",anonymize_ip:!0,client_id:"UA-179623617-1"})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-179623617-1" async></script></body></html>