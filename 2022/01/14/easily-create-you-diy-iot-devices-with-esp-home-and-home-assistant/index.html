<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>Easily create you DIY IoT devices with ESP Home and Home Assistant - DrosoCode</title><meta name=Description content="This is my cool site"><meta property="og:title" content="Easily create you DIY IoT devices with ESP Home and Home Assistant">
<meta property="og:description" content="When I started to tinker with home automation and electronics a few years ago, it was common to use arduino cards to create DIY connected devices. You would then communicate with a central server to send and receive information. The communications were usually done using usb, ethernet (using an ethernet shield) or radio (2.4Ghz or 433Mhz) with projects like MySensors.
Most of the time these cards were programmed using the “Arduino language” which is quite close to C++.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-14T00:00:00+01:00">
<meta property="article:modified_time" content="2022-01-14T00:00:00+01:00"><meta property="og:site_name" content="My cool site">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Easily create you DIY IoT devices with ESP Home and Home Assistant">
<meta name=twitter:description content="When I started to tinker with home automation and electronics a few years ago, it was common to use arduino cards to create DIY connected devices. You would then communicate with a central server to send and receive information. The communications were usually done using usb, ethernet (using an ethernet shield) or radio (2.4Ghz or 433Mhz) with projects like MySensors.
Most of the time these cards were programmed using the “Arduino language” which is quite close to C++.">
<meta name=application-name content="My cool site">
<meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/><link rel=prev href=https://thomasz.me/2021/11/29/upgrading-your-rgb-with-wled-aurora-and-openrgb/><link rel=next href=https://thomasz.me/2022/01/14/a-comparison-of-upscaling-software-in-2021/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Easily create you DIY IoT devices with ESP Home and Home Assistant","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thomasz.me\/2022\/01\/14\/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant\/"},"genre":"posts","keywords":"docker, arduino, iot, home assistant, hardware","wordcount":1312,"url":"https:\/\/thomasz.me\/2022\/01\/14\/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant\/","datePublished":"2022-01-14T00:00:00+01:00","dateModified":"2022-01-14T00:00:00+01:00","publisher":{"@type":"Organization","name":"drosocode"},"author":{"@type":"Person","name":"droso"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>My cool site</a>
</div><div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/projects/> Projects </a><a class=menu-item href=https://github.com/drosocode rel="noopener noreffer" target=_blank> Github </a><a class=menu-item href=/about/> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a>
</div></div></div></header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>My cool site</a>
</div><div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div></div><div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/projects/ title>Projects</a><a class=menu-item href=https://github.com/drosocode title rel="noopener noreffer" target=_blank>Github</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div></div></header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div></div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Easily create you DIY IoT devices with ESP Home and Home Assistant</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://github.com/drosocode title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>droso</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-01-14>2022-01-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1312 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#why-esp-home->Why ESP Home ?</a></li><li><a href=#getting-started-with-esp-home>Getting started with ESP Home</a></li><li><a href=#create-your-first-iot-device>Create your first IoT device</a></li><li><a href=#flashing-the-esp>Flashing the ESP</a></li></ul></nav></div></div><div class=content id=content><p>When I started to tinker with home automation and electronics a few years ago, it was common to use arduino cards to create DIY connected devices. You would then communicate with a central server to send and receive information. The communications were usually done using usb, ethernet (using an ethernet shield) or radio (2.4Ghz or 433Mhz) with projects like <a href=https://www.mysensors.org/ target=_blank rel="noopener noreffer">MySensors</a>.</p><p>Most of the time these cards were programmed using the “Arduino language” which is quite close to C++. I kept this habit when I switched to use the esp8266/esp32 cards but in the meantime, awesome projects were developped to facilitate the development of this kind of devices, especially dedicated ecosystems like <a href=https://espeasy.readthedocs.io/en/latest/ target=_blank rel="noopener noreffer">ESP-Easy</a>, <a href=https://tasmota.github.io/docs/ target=_blank rel="noopener noreffer">Tasmota</a> and <a href=https://esphome.io/ target=_blank rel="noopener noreffer">ESP Home</a>, which is the project that I decided to use.</p><h2 id=why-esp-home->Why ESP Home ?</h2><p>While Tasmota and ESP-Easy are “battery-included” firmwares that you flash on the esp board and then configure with a web ui, ESP Home compiles a firmware specially for your device based on a yaml configuration file that tells it which kind of technology (SPI, I2C, UART) and sensor (dht22, HC-SR04 …) you are using and on which pins they are accessible. It even allows you to manally add C++ code through “lambdas”. Another great point of ESP Home is the native integration to <a href=https://www.home-assistant.io/ target=_blank rel="noopener noreffer">Home Assistant</a> (a very powerful home automation system) so we can focus on actually creating our IoT device instead of bothering about communication with the server. So let’s get started !</p><h2 id=getting-started-with-esp-home>Getting started with ESP Home</h2><p>While this is not mandatory, I would recommend to install the ESP Home server using the docker image, which will facilitate the development of our devices with a user friendly web interface. (You can also skip this step and use directly ESP Home in <a href=https://esphome.io/guides/getting_started_command_line.html target=_blank rel="noopener noreffer">CLI</a>). So, I created the following docker-compose file to start the esphome dashboard and access it using traefik. I also decided to use ping instead of mdns to check for device status.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>esphome</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>esphome/esphome</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>TZ=Europe/Paris</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>ESPHOME_DASHBOARD_USE_PING=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>/app/docker/data/EspHome:/config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.lan_esphome.rule=Host(`esphome.domain.tld`)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.lan_esphome.entrypoints=https_lan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.lan_esphome.middlewares=authelia_lan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.lan_esphome.tls=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.services.lan_esphome.loadbalancer.server.port=6052</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.enable=true</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><figure><a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png title=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png data-thumbnail=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png data-sub-html="<h2>ESP Home dashboard</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png data-srcset="/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png, /2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png 1.5x, /2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png 2x" data-sizes=auto alt=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/esphome-dash.png width=90% height=630>
</a><figcaption class=image-caption>ESP Home dashboard</figcaption></figure><p>You now have access to your ESP Home dashboard and can create a new configuration by clicking on the “NEW DEVICE” button. You will then have to enter some information about your device and a default configuration will be generated.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>esphome</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>esp8266</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>board</span><span class=p>:</span><span class=w> </span><span class=l>esp01_1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>logger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable Home Assistant API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>api</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ota</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;ff16ebc60e9b22668b2e6fff77e6636f&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>wifi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span>!<span class=l>secret wifi_ssid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span>!<span class=l>secret wifi_password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Enable fallback hotspot (captive portal) in case wifi connection fails</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Test Fallback Hotspot&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mfp7hXdwozmk&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>captive_portal</span><span class=p>:</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>You should have something like this. The captive_portal and ap configuration will allow you to reconfigure your device in case your wifi is no longer available. The “normal” connection to your wifi is configured with the ssid and password keys. The <code>!secret</code> refers to the data stored in the secrets section (in the top right corner of the ui). In there you can configure your wifi credentials like this:</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>wifi_ssid</span><span class=p>:</span><span class=w> </span><span class=l>yourssid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>wifi_password</span><span class=p>:</span><span class=w> </span><span class=l>yourpassword</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>You now have the basic configuration needed to flash your device, we will now add the specific configuration to register your sensors.</p><h2 id=create-your-first-iot-device>Create your first IoT device</h2><p>Here’s the device that I will make: a simple display based on 4 8×8 matrices in a wooden enclosure painted in black.</p><p>The device will also have a photoresistor to adapt the brightness of the matrices and a row of 4 buttons to trigger some actions on home assistant. Everything is wired on a node mcu (with an esp8266).</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/display_1.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/display_1.png>
</a>
<figcaption class=image-caption>
Wiring
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/display_2.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/display_2.png>
</a>
<figcaption class=image-caption>
Finished result
</figcaption></figure></div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>esphome</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>afficheur</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>ESP8266</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>board</span><span class=p>:</span><span class=w> </span><span class=l>nodemcuv2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>logger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable Home Assistant API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>api</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ota</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>wifi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span>!<span class=l>secret &#34;wifi_ssid&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span>!<span class=l>secret &#34;wifi_password&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>manual_ip</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_ip</span><span class=p>:</span><span class=w> </span><span class=m>10.20.8.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gateway</span><span class=p>:</span><span class=w> </span><span class=m>10.20.1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>subnet</span><span class=p>:</span><span class=w> </span><span class=m>255.255.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Enable fallback hotspot (captive portal) in case wifi connection fails</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Afficheur Fallback Hotspot&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>captive_portal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status_led</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>D4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#===================== display data =============================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>font</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;pixelmix.ttf&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>digit_font</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=m>8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>time</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>homeassistant</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>hass_time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>globals</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>new_text</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>initial_value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>txt_cycles</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>initial_value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>text_sensor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>homeassistant</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;afficheur texte&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>entity_id</span><span class=p>:</span><span class=w> </span><span class=l>input_text.afficheur_txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>on_value</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>lambda</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          </span><span class=w>          </span><span class=l>id(new_text) = 0;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#===================== display settings =============================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>clk_pin</span><span class=p>:</span><span class=w> </span><span class=l>D5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>mosi_pin</span><span class=p>:</span><span class=w> </span><span class=l>D7</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>display</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>max7219digit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cs_pin</span><span class=p>:</span><span class=w> </span><span class=l>D8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>num_chips</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rotate_chip</span><span class=p>:</span><span class=w> </span><span class=m>90</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>matrixdisplay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>intensity</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scroll_speed</span><span class=p>:</span><span class=w> </span><span class=l>50ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scroll_mode</span><span class=p>:</span><span class=w> </span><span class=l>STOP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>update_interval</span><span class=p>:</span><span class=w> </span><span class=l>3s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>lambda</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      if (id(new_text) &lt;= id(txt_cycles)) {
</span></span></span><span class=line><span class=cl><span class=sd>        if(id(new_text) == 0) {
</span></span></span><span class=line><span class=cl><span class=sd>          id(txt_cycles) = ceil(strlen(id(txt).state.c_str()) / 6);
</span></span></span><span class=line><span class=cl><span class=sd>        }
</span></span></span><span class=line><span class=cl><span class=sd>        it.printf(0, 0, id(digit_font), &#34;%s&#34;, id(txt).state.c_str());
</span></span></span><span class=line><span class=cl><span class=sd>        id(new_text)++;
</span></span></span><span class=line><span class=cl><span class=sd>      } else {
</span></span></span><span class=line><span class=cl><span class=sd>        it.strftime(0, 0, id(digit_font), &#34; %H:%M&#34;, id(hass_time).now());
</span></span></span><span class=line><span class=cl><span class=sd>      }</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>     
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#===================== display control =============================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>number</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Screen Brightness</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>min_value</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>max_value</span><span class=p>:</span><span class=w> </span><span class=m>15</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>step</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>set_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>lambda</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          </span><span class=w>          </span><span class=l>id(matrixdisplay).intensity(x);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>switch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Screen Enable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>lambda</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          </span><span class=w>          </span><span class=l>id(matrixdisplay).turn_on_off(true);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_off_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>then</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>lambda</span><span class=p>:</span><span class=w> </span><span class=p>|-</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          </span><span class=w>          </span><span class=l>id(matrixdisplay).turn_on_off(false);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#===================== sensors =============================</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>sensor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>adc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>source_sensor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>A0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>resistance</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sensor</span><span class=p>:</span><span class=w> </span><span class=l>source_sensor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>configuration</span><span class=p>:</span><span class=w> </span><span class=l>DOWNSTREAM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resistor</span><span class=p>:</span><span class=w> </span><span class=l>10kOhm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Resistance Sensor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>binary_sensor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>gpio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>D3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Btn 1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>gpio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>D2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Btn 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>gpio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>D1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Btn 3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>gpio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>D0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Btn 4&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span></code></pre></td></tr></table></div></div><p>This is the full code for our display.</p><p>I defined a <a href=https://esphome.io/components/status_led.html target=_blank rel="noopener noreffer">status led</a> wired on pin <code>D4</code> to have a quick indication of the status of the connection (the led itself is located on the back of the display).</p><p>In order to display text, you will need to configure a font, here I am using the pixelmix.ttf file that you can download <a href=https://www.dafont.com/pixelmix.font target=_blank rel="noopener noreffer">here</a>. You then need to place the font file in the same directory of your config file (in my case <code>/app/docker/data/EspHome</code>, see the docker-compose file).</p><p>As I want to use the display as a clock when I have no message to show, I defined a <a href=https://esphome.io/components/time.html#home-assistant-time-source target=_blank rel="noopener noreffer">time</a> section with home assistant as the source. I also define 2 global variables to help to switch between the “message mode” and the “clock mode”, and a text sensor to allow home assistant to send a message to display.</p><p>My matrices are of type max7219. They communicate using SPI, so I defined a spi section with the clk and mosi pins. I can then define a <a href=https://esphome.io/components/display/max7219digit.html target=_blank rel="noopener noreffer">max7219digit</a> component and specifiy the CS pin. The num_chips key indicates the number of matrices that I have connected, here 4. I used custom C++ code to define the message to display using the lambda key. This code displays the message from the text sensor if it has changed or defaults to a clock. The display is refreshed every 3 seconds.</p><p>I also defined 2 template switches: a slider to control the brightness of the matrices from home assistant and a switch to turn on/off the display.</p><p>For the sensors part, I defined an <a href=https://esphome.io/components/sensor/adc.html target=_blank rel="noopener noreffer">adc</a> component with the pin A0 where my photoresistor is connected and a <a href="https://esphome.io/components/sensor/resistance.html?highlight=resistance" target=_blank rel="noopener noreffer">resistance</a> component that converts the voltage to resistance and reports it to home assistant. I also defined 4 binary sensors for the buttons disposed on top of the display.</p><h2 id=flashing-the-esp>Flashing the ESP</h2><p>To flash your esp click on the install button. For the first time I recommand to use the Manual Dowload option and use <a href=https://github.com/esphome/esphome-flasher/releases target=_blank rel="noopener noreffer">ESPHome-Flasher</a> (you can also flash it using a chrome-based browser but it will be slower). Futures updates can be done via OTA so you will only need to plug your device to your computer for the first installation.</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_1.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_1.png>
</a>
<figcaption class=image-caption>
Firmware download screen
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_2.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_2.png>
</a>
<figcaption class=image-caption>
Firmware compilation
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_3.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/flash_3.png>
</a>
<figcaption class=image-caption>
Flashing the firmare with ESPHome-Flasher
</figcaption></figure></div><p>You are now ready to go ! Your device will connect to your wifi and should appear in the device section of home assistant.</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/hass.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/hass.png>
</a>
<figcaption class=image-caption>
The device section in the configuration
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/hass2.png>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/hass2.png>
</a>
<figcaption class=image-caption>
A card with all the device controls
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/text.gif>
<img src=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/assets/text.gif>
</a>
<figcaption class=image-caption>
The finished result
</figcaption></figure></div><p>I would highly recommend ESP Home as it is a really interesting framework to create specific firmware for your IoT devices. It also allows a great saving of time compared to the development of a custom firmware in C ++ “from scratch”. So I can only recommend to check out their <a href=https://esphome.io/ target=_blank rel="noopener noreffer">website</a> for more information.</p></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2022-01-14</span>
</div></div><div class=post-info-line>
<div class=post-info-md></div><div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ data-title="Easily create you DIY IoT devices with ESP Home and Home Assistant" data-hashtags="docker,arduino,iot,home assistant,hardware"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ data-hashtag=docker><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ data-title="Easily create you DIY IoT devices with ESP Home and Home Assistant"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ data-title="Easily create you DIY IoT devices with ESP Home and Home Assistant"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://thomasz.me/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ data-title="Easily create you DIY IoT devices with ESP Home and Home Assistant"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span>
</div></div></div><div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/docker/>docker</a>,&nbsp;<a href=/tags/arduino/>arduino</a>,&nbsp;<a href=/tags/iot/>iot</a>,&nbsp;<a href=/tags/home-assistant/>home assistant</a>,&nbsp;<a href=/tags/hardware/>hardware</a></section><section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section></div><div class=post-nav><a href=/2021/11/29/upgrading-your-rgb-with-wled-aurora-and-openrgb/ class=prev rel=prev title="Upgrading your RGB with WLED, Aurora and OpenRGB"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Upgrading your RGB with WLED, Aurora and OpenRGB</a>
<a href=/2022/01/14/a-comparison-of-upscaling-software-in-2021/ class=next rel=next title="A comparison of upscaling software in 2021">A comparison of upscaling software in 2021<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div></main><footer class=footer>
<div class=footer-container><div class=footer-line>© <script>document.write("2019 - "+(new Date).getFullYear())</script> DrosoCode | <a href=/privacy-policy>Privacy Policy</a> | <a href=/terms-of-use>Terms of Use</a> | <a href=/index.xml>RSS</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/css/lightgallery-bundle.min.css><link rel=stylesheet href=/custom.css><link rel=stylesheet href=/devicon.min.css><link rel=stylesheet href=/glide.min.css><script type=text/javascript src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script type=text/javascript src=https://droso.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=/glide.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},lightgallery:!0,search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-179623617-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-179623617-1" async></script></body></html>