<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<title>Create your own ambilight solution - DrosoCode</title><meta name=Description content="This is my cool site"><meta property="og:title" content="Create your own ambilight solution">
<meta property="og:description" content="Ambilight is a technology of Bias lighting used in Phillips TVs which illumitates the back of your tv with colors related to the image displayed. Their solution is expensive, but you can create your own solution using an ESP 8266 controller and some cheap led strips.
In order to adapt the lights to the image, the ambilight system needs to capture the images displayed on your tv. There are 2 main ways to do that: you can use a physical box to capture the video using an HDMI splitter and an acquisition card between your devices (Mi Box, Nvidia Shield, Xbox &mldr;) and your TV or you can use a software solution to directly stream the video from a device (PC, Android TV &mldr;).">
<meta property="og:type" content="article">
<meta property="og:url" content="https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-05-30T00:00:00+01:00">
<meta property="article:modified_time" content="2022-05-30T00:00:00+01:00"><meta property="og:site_name" content="My cool site">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Create your own ambilight solution">
<meta name=twitter:description content="Ambilight is a technology of Bias lighting used in Phillips TVs which illumitates the back of your tv with colors related to the image displayed. Their solution is expensive, but you can create your own solution using an ESP 8266 controller and some cheap led strips.
In order to adapt the lights to the image, the ambilight system needs to capture the images displayed on your tv. There are 2 main ways to do that: you can use a physical box to capture the video using an HDMI splitter and an acquisition card between your devices (Mi Box, Nvidia Shield, Xbox &mldr;) and your TV or you can use a software solution to directly stream the video from a device (PC, Android TV &mldr;).">
<meta name=application-name content="My cool site">
<meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/><link rel=prev href=https://thomasz.me/2022/01/14/a-comparison-of-upscaling-software-in-2021/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'>
<noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Create your own ambilight solution","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/thomasz.me\/2022\/05\/30\/create-you-own-ambilight-solution\/"},"genre":"posts","keywords":"docker, home assistant, iot, arduino, esp8266","wordcount":1929,"url":"https:\/\/thomasz.me\/2022\/05\/30\/create-you-own-ambilight-solution\/","datePublished":"2022-05-30T00:00:00+01:00","dateModified":"2022-05-30T00:00:00+01:00","publisher":{"@type":"Organization","name":"drosocode"},"author":{"@type":"Person","name":"droso"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>My cool site</a>
</div><div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/projects/> Projects </a><a class=menu-item href=https://github.com/drosocode rel="noopener noreffer" target=_blank> Github </a><a class=menu-item href=/about/> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a>
</div></div></div></header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=DrosoCode>My cool site</a>
</div><div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div></div><div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw" aria-hidden=true></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span>
</div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/projects/ title>Projects</a><a class=menu-item href=https://github.com/drosocode title rel="noopener noreffer" target=_blank>Github</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a></div></div></header><div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div></div><main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Create your own ambilight solution</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://github.com/drosocode title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>droso</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-05-30>2022-05-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1929 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;10 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span>
</div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#first-method>First Method</a></li><li><a href=#second-method>Second Method</a>
<ul>
<li><a href=#presentation>Presentation</a></li><li><a href=#configuration-of-the-hyperion-clients>Configuration of the Hyperion Clients</a></li><li><a href=#configuration-of-the-hyperion-server>Configuration of the Hyperion Server</a></li><li><a href=#configuration-of-the-esp8266>Configuration of the ESP8266</a></li><li><a href=#configuration-of-home-assistant-optional>Configuration of Home Assistant (Optional)</a></li></ul></li><li><a href=#bonus>Bonus</a>
<ul>
<li><a href=#fixing-the-audio-bar>Fixing the audio bar</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p>Ambilight is a technology of Bias lighting used in Phillips TVs which illumitates the back of your tv with colors related to the image displayed. Their solution is expensive, but you can create your own solution using an ESP 8266 controller and some cheap led strips.</p><p>In order to adapt the lights to the image, the ambilight system needs to capture the images displayed on your tv. There are 2 main ways to do that: you can use a physical box to capture the video using an HDMI splitter and an acquisition card between your devices (Mi Box, Nvidia Shield, Xbox &mldr;) and your TV or you can use a software solution to directly stream the video from a device (PC, Android TV &mldr;).</p><h2 id=first-method>First Method</h2><p>My first attempt was with the fist method (which was at that time the most used). The advantages are that you don&rsquo;t need to install a third-party software in order to connect a device to your ambilight. You only need to plug the HDMI output in the splitter and it should work. You can even connect an HDMI switch before the splitter to connect multiple devices to your amblight system.</p><p>However a stream may be protected with HDCP: a DRM protection which prevents it from being recorded, but there are many <a href=https://en.wikipedia.org/wiki/High-bandwidth_Digital_Content_Protection#Circumvention target=_blank rel="noopener noreffer">flaws</a> in this technology and you can find some cheap HDMI splitters or HDMI-to-RCA converters from China that are able to strip the HDCP to obtain a readable stream.</p><p>You then need to capture and process the video signal, for this task I used an RCA-to-USB key (the image quality isn&rsquo;t important as the image is only used to detect the colors on the borders of the image). I used a Raspberry PI B+ to process the image and an arduino to control the led strips. The schema looked like this:</p><figure><a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg title=/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg data-thumbnail=/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg data-sub-html="<h2>Schema of the first version</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg data-srcset="/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg, /2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg 1.5x, /2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg 2x" data-sizes=auto alt=/2022/05/30/create-you-own-ambilight-solution/assets/v1.jpg width=90% height=1039>
</a><figcaption class=image-caption>Schema of the first version</figcaption></figure><p>I then sticked some WS2812B led strips behind the TV and renovated an old metal box to fit all the components for the ambilight system. This box already had an integrated power supply that I used to power the raspberry pi and the leds in 5V.</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/box_1.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/box_1.jpg>
</a>
<figcaption class=image-caption>
The box that I recovered
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/box_2.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/box_2.jpg>
</a>
<figcaption class=image-caption>
Filling the box with all the components
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/box_3.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/box_3.jpg>
</a>
<figcaption class=image-caption>
The finished result
</figcaption></figure></div><p>On the software side, I used <a href=https://github.com/hyperion-project/hyperion target=_blank rel="noopener noreffer">Hyperion</a> (the first version) and the <a href=https://github.com/hyperion-project/hypercon target=_blank rel="noopener noreffer">Hypercon.jar</a> program to create the configuration file. The Raspberry PI would then send the orders to the connected arduino card that controlled the leds.</p><figure><a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg title=/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg data-thumbnail=/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg data-sub-html="<h2>the final result on the tv</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg data-srcset="/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg, /2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg 1.5x, /2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg 2x" data-sizes=auto alt=/2022/05/30/create-you-own-ambilight-solution/assets/tv_1.jpg width=70% height=1380>
</a><figcaption class=image-caption>the final result on the tv</figcaption></figure><p>This method worked pretty well but the box was pretty big and when I moved in, I didn’t have it on hand (nor did I have the necessary components to build a new one). So I decided to try another method.</p><h2 id=second-method>Second Method</h2><h3 id=presentation>Presentation</h3><p>With this second solution, the splitter, converter and grabber are no longer needed: I just connect the HDMI devices directly to my tv and these devices will stream their video to an external server with <a href=https://github.com/hyperion-project/hyperion.ng target=_blank rel="noopener noreffer">Hyperion-ng</a> (a new version of hyperion) which will send led control commands to an ESP 8266 over wifi (using <a href=https://en.wikipedia.org/wiki/DMX512#Wireless_operation target=_blank rel="noopener noreffer">E 1.31</a>). Note that with this version, it will be impossible to capture DRM protected content.</p><figure><a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg title=/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg data-thumbnail=/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg data-sub-html="<h2>Schema of the second version</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg data-srcset="/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg, /2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg 1.5x, /2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg 2x" data-sizes=auto alt=/2022/05/30/create-you-own-ambilight-solution/assets/v2.jpg width=90% height=807>
</a><figcaption class=image-caption>Schema of the second version</figcaption></figure><h3 id=configuration-of-the-hyperion-clients>Configuration of the Hyperion Clients</h3><p>To stream the video feed from my android tv box, I used the <a href=https://github.com/abrenoch/hyperion-android-grabber target=_blank rel="noopener noreffer">hyperion-android-grabber</a> app and for my PC I used the <a href=https://github.com/sabaatworld/HyperionScreenCap target=_blank rel="noopener noreffer">HyperionScreenCap</a> software.</p><p>To install a third-party apk on android tv, you need to enable ADB in the developer settings and connect to your box from your PC with <code>adb connect 192.168.1.X</code> You can then type <code>adb install ./tv-release.apk</code> to install the apk on your box. The app sould appear in your applications menu, if this is not the case, you can launch it manually with <code>adb shell am start -n com.abrenoch.hyperiongrabber/.tv.activities.MainActivity</code>. You can then go in the app’s settings and configure the IP of your server and the protobuf port (that will be used to receive the video from the box). You also need to set the priority between 100 and 199.</p><p>For android tv, you may need to disable some hadware acceleration features that prevents the image from being captured, for Kodi, you need to disable the <code>MediaCodec (Surface)</code> feature in the settings.</p><p>Note that any service serving drm protected content will not work (like Netflix, Amazon Prime, Twitch &mldr;).
For youtube, you can bypass this protection by using the excellent <a href=https://github.com/yuliskov/SmartTubeNext target=_blank rel="noopener noreffer">SmartTube</a> app.</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/android_grabber.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/android_grabber.jpg>
</a>
<figcaption class=image-caption>
Android Grabber Settings
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/kodi_settings.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/kodi_settings.jpg>
</a>
<figcaption class=image-caption>
Kodi Settings
</figcaption></figure></div><h3 id=configuration-of-the-hyperion-server>Configuration of the Hyperion Server</h3><p>Once the clients are configured, you need to setup the hyperion-ng server that will receive the video streams from the clients, process it and send the commands to you leds. You can use the following dockerfile and docker-compose to run it.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> debian:11-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> apt-get install -y <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  wget jq <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  qtbase5-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libqt5serialport5-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libqt5sql5-sqlite <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libqt5svg5-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libqt5x11extras5-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  build-essential <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libusb-1.0-0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libcec-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libavahi-core-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libavahi-compat-libdnssd-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxcb-util0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxcb-randr0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxcb-shm0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxcb-render0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxcb-image0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxrandr-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libxrender-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libturbojpeg0-dev <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  libssl-dev<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> wget <span class=s2>&#34;https://api.github.com/repos/hyperion-project/hyperion.ng/releases&#34;</span> -O - <span class=p>|</span> jq -r <span class=s1>&#39;.[0].assets[] | select(.name | contains(&#34;x86_64.deb&#34;)).browser_download_url&#39;</span> <span class=p>|</span> wget -i - -O hyperion.deb <span class=o>&amp;&amp;</span> dpkg -i hyperion.deb<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=s2>&#34;/usr/share/hyperion/bin/hyperiond&#34;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hyperion</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>build</span><span class=p>:</span><span class=w> </span><span class=l>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>/app/docker/data/Hyperion:/root/.hyperion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.hyperion.rule=Host(`hyperion.domain.tld`)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.hyperion.tls=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.routers.hyperion.entrypoints=https_lan</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.http.services.hyperion.loadbalancer.server.port=8090</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>traefik.enable=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=m>19400</span><span class=p>:</span><span class=m>19400</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=m>19444</span><span class=p>:</span><span class=m>19444</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=m>19445</span><span class=p>:</span><span class=m>19445</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=m>19333</span><span class=p>:</span><span class=m>19333</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=configuration-of-the-esp8266>Configuration of the ESP8266</h3><p>The last thing to configure is the ESP 8266, that will receive the commands from the Hyperion server (with the E1.31 protocol) and control the leds. To do this easily, we can use ESP Home (see my previous post <a href=/2022/01/14/easily-create-you-diy-iot-devices-with-esp-home-and-home-assistant/ rel>here</a>). With the basic config, you just need to add a <a href=https://esphome.io/components/light/neopixelbus.html target=_blank rel="noopener noreffer">neopixelbus</a> component with the type, command pin and amount of leds, and add the E1.31 effect to allow hyperion to control the leds. While writing the configuration file, I also decided to add an infrared led to control my TV from Home Assistant. For this you can either attach an IR receiver to capture the IR codes from your remote or try to find the codes online. Fom my TV brand (LG) I have found the following <a href=https://gist.github.com/francis2110/8f69843dd57ae07dce80 target=_blank rel="noopener noreffer">gist</a> with all the codes.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>esphome</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ambilight</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>ESP32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>board</span><span class=p>:</span><span class=w> </span><span class=l>esp32doit-devkit-v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>logger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable Home Assistant API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>api</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ota</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>wifi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span>!<span class=l>secret &#34;wifi_ssid&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>password</span><span class=p>:</span><span class=w> </span>!<span class=l>secret &#34;wifi_password&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>manual_ip</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_ip</span><span class=p>:</span><span class=w> </span><span class=m>10.20.8.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gateway</span><span class=p>:</span><span class=w> </span><span class=m>10.20.1.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>subnet</span><span class=p>:</span><span class=w> </span><span class=m>255.255.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Enable fallback hotspot (captive portal) in case wifi connection fails</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ssid</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Ambilight Fallback Hotspot&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>captive_portal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status_led</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>############################ IR TV ON/OFF #############</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>remote_transmitter</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>carrier_duty_percent</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=l>%</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>switch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Power&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF10EF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Input&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFD02F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Input&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFD02F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Up&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF02FD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Down&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF827D</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Right&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF609F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Left&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFE01F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG OK&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF22DD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Exit&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFDA25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG HDMI1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF738C</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG HDMI2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF33CC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG HDMI3&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF9768</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Settings&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFC23D</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Vol+&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF40BF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Vol-&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DFC03F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG Mute&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF906F</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LG 3D&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>turn_on_action</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>remote_transmitter.transmit_lg</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w> </span><span class=l>0x20DF3BC4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>nbits</span><span class=p>:</span><span class=w> </span><span class=m>32</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>########################## LEDs #####################</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>e131</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>method: multicast # default</span><span class=p>:</span><span class=w> </span><span class=l>register E1.31 to Multicast group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>wled</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>light</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>neopixelbus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>GRB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO18</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>num_leds</span><span class=p>:</span><span class=w> </span><span class=m>146</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;TV LEDs&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>variant</span><span class=p>:</span><span class=w> </span><span class=l>WS2812</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>effects</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>e131</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>universe</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>channels</span><span class=p>:</span><span class=w> </span><span class=l>RGB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>wled</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>21324</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          
</span></span></span></code></pre></td></tr></table></div></div><figure><a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg title=/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg data-thumbnail=/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg data-sub-html="<h2>Wiring of the second version</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg data-srcset="/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg, /2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg 1.5x, /2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg 2x" data-sizes=auto alt=/2022/05/30/create-you-own-ambilight-solution/assets/tv_wiring.jpg width=90% height=1547>
</a><figcaption class=image-caption>Wiring of the second version</figcaption></figure><h3 id=configuration-of-home-assistant-optional>Configuration of Home Assistant (Optional)</h3><p>You should now be able to add all the esp home devices in Home Assistant. You can see below that I also configured the Hyperion integration. We now have a complete remote to control our tv thanks to the IR led and a light entity representing our led strip that we can use to either use like a normal color bulb, set it in E1.31 mode to allow hyperion to control it, or set it in WLED mode to allow it to sync with other wled devices (using the Effect menu).</p><figure><a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/hass.png title=/2022/05/30/create-you-own-ambilight-solution/assets/hass.png data-thumbnail=/2022/05/30/create-you-own-ambilight-solution/assets/hass.png data-sub-html="<h2>The devices in Home Assistant</h2>">
<img class=lazyload src=/svg/loading.min.svg data-src=/2022/05/30/create-you-own-ambilight-solution/assets/hass.png data-srcset="/2022/05/30/create-you-own-ambilight-solution/assets/hass.png, /2022/05/30/create-you-own-ambilight-solution/assets/hass.png 1.5x, /2022/05/30/create-you-own-ambilight-solution/assets/hass.png 2x" data-sizes=auto alt=/2022/05/30/create-you-own-ambilight-solution/assets/hass.png width=90% height=713>
</a><figcaption class=image-caption>The devices in Home Assistant</figcaption></figure><p>You can also see a TV switch in Home Assistant. I created this device to be able to switch the tv on and off using the IR code corrsponding to the &ldquo;power&rdquo; button on the remote and based on the TV&rsquo;s status on the network (as you can see in the tv&rsquo;s picture above this TV has an ethernet port, so if the TV is on, then we can ping its IP address). Here is the configuration used to create this device:</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>switch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>switches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tv</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{{ is_state(&#39;binary_sensor.tv_status&#39;, &#39;on&#39;) }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>turn_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class=l>switch.turn_on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>data_template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>entity_id</span><span class=p>:</span><span class=w> </span><span class=p>&gt;</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>              {% if is_state(&#39;binary_sensor.tv_status&#39;, &#39;off&#39;) %}
</span></span></span><span class=line><span class=cl><span class=sd>              switch.lg_power
</span></span></span><span class=line><span class=cl><span class=sd>              {% else %}
</span></span></span><span class=line><span class=cl><span class=sd>              null
</span></span></span><span class=line><span class=cl><span class=sd>              {% endif %}</span><span class=w>              
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>turn_off</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class=l>switch.turn_on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>data_template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>entity_id</span><span class=p>:</span><span class=w> </span><span class=p>&gt;</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>              {% if is_state(&#39;binary_sensor.tv_status&#39;, &#39;on&#39;) %}
</span></span></span><span class=line><span class=cl><span class=sd>              switch.lg_power
</span></span></span><span class=line><span class=cl><span class=sd>              {% else %}
</span></span></span><span class=line><span class=cl><span class=sd>              null
</span></span></span><span class=line><span class=cl><span class=sd>              {% endif %}</span><span class=w>              
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>binary_sensor</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>ping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=m>10.20.4.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tv_status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>count</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scan_interval</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=bonus>Bonus</h2><h3 id=fixing-the-audio-bar>Fixing the audio bar</h3><p>My Phillips audio bar also stopped working after some time, so I decided to fix it. As I don&rsquo;t have a lot of knowledge about electronics I wasen&rsquo;t able to identify the faulty component on the board, so I simply ordered a cheap 2.1 amplifier. As this ampifier wouldn&rsquo;t fit into the bar, I rewired the bar&rsquo;s speakers to RCA plugs on the bar and then used these plugs to connect the bar to the amplifier.</p><p>But there was no remote with this amplifier, it&rsquo;s not much of a problem for the volume (as we can still adjust it from the tv) but it isn&rsquo;t practical to power it on and off. So I created a simple plug with a 230v relay powered by a usb port. The usb plug is connected to the TV, so when the TV is powered on, the usb ports will also be powered, which will then power the relay and let the current pass to power the amplifier.</p><div class=galleryContainer>
<figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/audio1.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/audio1.jpg>
</a>
<figcaption class=image-caption>
Fixing the audio bar
</figcaption></figure><figure class=galleryItem>
<a class=lightgallery href=/2022/05/30/create-you-own-ambilight-solution/assets/usb_plug.jpg>
<img src=/2022/05/30/create-you-own-ambilight-solution/assets/usb_plug.jpg>
</a>
<figcaption class=image-caption>
The usb relay plug
</figcaption></figure></div><h2 id=conclusion>Conclusion</h2><p>We have seen 2 different methods to create an amibilght system and especially to capture video, both of them having their advantages and drawbacks.</p><p>The second one requires less hardware and space but you need to install a client software on each device that you want to use (and some devices will just not work like the PS4 where you can&rsquo;t install anything), moreover you can only use this method to capture unprotected content.</p><p>In contrast to this, the first method, while requiring significantly more hardware, will likely allow you to capture pretty much anything and once the first setup is done, it should be only a matter of plugging the device on the HDMI switch to add a new device.</p><p>So, in the next version (an hopefully the last one), I think that I will use a bit of both methods with a standalone capture device like in the first method based on a raspberry pi and either an RCA grabber or directly with a CSI-to-HDMI adapter, and a command part kept as is, with the ESP8266 that allows to control the tv and the leds from Hyperion or directly from Home Assistant.</p></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2022-05-30</span>
</div></div><div class=post-info-line>
<div class=post-info-md></div><div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/ data-title="Create your own ambilight solution" data-hashtags="docker,home assistant,iot,arduino,esp8266"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/ data-hashtag=docker><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/ data-title="Create your own ambilight solution"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/ data-title="Create your own ambilight solution"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://thomasz.me/2022/05/30/create-you-own-ambilight-solution/ data-title="Create your own ambilight solution"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span>
</div></div></div><div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/docker/>docker</a>,&nbsp;<a href=/tags/home-assistant/>home assistant</a>,&nbsp;<a href=/tags/iot/>iot</a>,&nbsp;<a href=/tags/arduino/>arduino</a>,&nbsp;<a href=/tags/esp8266/>esp8266</a></section><section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section></div><div class=post-nav><a href=/2022/01/14/a-comparison-of-upscaling-software-in-2021/ class=prev rel=prev title="A comparison of upscaling software in 2021"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>A comparison of upscaling software in 2021</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div></main><footer class=footer>
<div class=footer-container><div class=footer-line>© <script>document.write("2019 - "+(new Date).getFullYear())</script> DrosoCode | <a href=/privacy-policy>Privacy Policy</a> | <a href=/terms-of-use>Terms of Use</a> | <a href=/index.xml>RSS</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw" aria-hidden=true></i>
</a>
</div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/css/lightgallery-bundle.min.css><link rel=stylesheet href=/custom.css><link rel=stylesheet href=/devicon.min.css><link rel=stylesheet href=/glide.min.css><script type=text/javascript src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script type=text/javascript src=https://droso.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.4.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=/glide.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},lightgallery:!0,search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-179623617-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-179623617-1" async></script></body></html>